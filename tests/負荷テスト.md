# 負荷・パフォーマンステスト設計書

## 概要
このドキュメントは、「小説らいたー」が大規模なプロジェクトデータを扱った際のパフォーマンスと安定性を評価するためのテストケースを定義します。大量の本文、多数の設定項目、長時間の連続使用などをシミュレートし、アプリケーションの応答性やメモリ使用量を検証します。

## テスト目的
- アプリケーションが現実的な規模の小説プロジェクト（例：長編小説）を扱えることを保証する。
- データ量の増加に伴い、パフォーマンスが許容できないレベルまで低下しないことを確認する。
- 長時間の連続使用によって、メモリリークなどの問題が発生しないことを確認する。

## 測定項目
- **UI応答性:** ボタンクリックやスクロールなどの操作に対する画面の反応速度。
- **AI応答時間:** プロンプト送信からAIの応答が表示されるまでの時間。
- **メモリ使用量:** ブラウザの開発者ツールで確認できるメモリフットプリントの推移。
- **CPU使用率:** 操作中のCPU使用率のスパイクや持続的な高負荷の有無。

---

## 詳細テストケース

### データ量増加テスト

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-LOAD-DATA-001**| 大量の本文 (チャンク数) | 1. 1000個以上の`NovelChunk`を持つプロジェクトデータを作成（スクリプト等で生成）し、インポート<br>2. 本文エリアをスクロールする<br>3. 末尾に新しいチャンクを追加する | 1. スクロールがカクつかず、スムーズに行える<br>2. 新しいチャンクの追加が、数秒以内に完了する<br>3. メモリ使用量が極端に増大しない。 |
| **TC-LOAD-DATA-002**| 巨大な本文 (文字数) | 1. 1つの`NovelChunk`に50万文字以上のテキストを含むプロジェクトをインポート<br>2. そのチャンクを編集モードで開く | 1. 編集モードへの切り替えが現実的な時間（例：5秒以内）で完了する<br>2. テキストエリア内でのカーソル移動や文字入力が、遅延なく行える。 |
| **TC-LOAD-DATA-003**| 大量のキャラクター設定 | 1. 200以上のキャラクターを持つプロジェクトをインポート<br>2. 左パネルのキャラクターリストを表示・スクロール<br>3. 相関図モーダルを開く | 1. キャラクターリストの表示やスクロールがスムーズ<br>2. 相関図モーダルの初期表示が現実的な時間で完了し、操作可能である。 |
| **TC-LOAD-DATA-004**| 大量のナレッジ設定 | 1. 500以上のナレッジ項目を持つプロジェクトをインポート<br>2. ナレッジベース一覧モーダルを開き、検索やタグ絞り込みを行う<br>3. AIに執筆を指示する | 1. ナレッジ一覧モーダルの表示や操作が軽快<br>2. ナレッジの量が増えても、AIの応答時間が極端に長くならない。 |

### 連続操作・長時間利用テスト

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-LOAD-OP-001** | Undo/Redoの連続実行 | 1. 大規模プロジェクト（TC-LOAD-DATA-001のデータ）で、本文編集や設定変更を100回以上繰り返す<br>2. Undoボタンを連続で押し続け、最初の状態まで戻れるか確認<br>3. Redoボタンを連続で押し、最新の状態まで戻れるか確認 | 1. Undo/Redoの各操作が数秒以内に完了する<br>2. 連続実行中にアプリがフリーズしたり、メモリ使用量が急増したりしない<br>3. 履歴が破損せず、最初と最新の状態に正しく復元できる。 |
| **TC-LOAD-OP-002** | 長時間利用シミュレーション | 1. アプリケーションを開いたまま、1時間以上放置する<br>2. その後、通常通り操作（AIへの指示、設定変更など）を行う<br>3. 開発者ツールで、放置前と放置後のメモリ使用量を比較する | 1. 放置後も、操作への応答性が低下していない<br>2. メモリ使用量が放置時間に応じて線形に増加し続けていない（メモリリークがない）。 |
| **TC-LOAD-OP-003** | AIとの連続対話 | 相談モードでAIとの対話を100ターン以上続ける | 1. チャット履歴が増えても、スクロールや新規メッセージの表示がスムーズ<br>2. 後半の対話でも、AIの応答速度が極端に遅くならない。 |

---
