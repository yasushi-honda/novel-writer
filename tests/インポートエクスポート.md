# インポート・エクスポート機能テスト設計書

## 概要
このドキュメントは、「小説らいたー」のプロジェクトデータの入出力に関するテストケースを定義します。プロジェクト全体のバックアップ/移行に使われるJSON形式、プレーンテキストでの書き出しに使われるTXT形式、そして装飾を保持した閲覧用のHTML形式が対象です。

## テスト目的
- プロジェクトデータを損失なく、正確にインポートおよびエクスポートできることを保証する。
- 各書き出し形式が、仕様通りのフォーマットで出力されることを確認する。
- 不正な形式のファイルのインポートなど、エラーケースに適切に対応できることを確認する。

## 前提条件
- `test_world_sample.json` をテスト用の基準データとして使用する。

---

## テスト項目一覧

| 機能分類 | テスト項目 |
| :--- | :--- |
| **プロジェクト管理** | 新規作成、既存プロジェクトを開く、削除 |
| **JSONエクスポート** | プロジェクト全体のデータ書き出し |
| **JSONインポート** | 正常なプロジェクトファイルの読み込み、異常系ファイルのハンドリング |
| **TXTエクスポート** | 本文のプレーンテキスト書き出し |
| **HTMLエクスポート** | 書式・画像付きのHTML書き出し、各種オプションの反映 |

---

## 詳細テストケース

### プロジェクト管理

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-IE-PRJ-001** | 新規プロジェクト作成 | 1. プロジェクト選択画面でタイトルを入力し「作成」を押す | 新しい空のプロジェクトが作成され、執筆画面に遷移する。 |
| **TC-IE-PRJ-002** | プロジェクトの削除 | 1. プロジェクト選択画面で既存プロジェクトのゴミ箱アイコンを押す<br>2. 確認ダイアログで「OK」を押す | プロジェクトがリストから削除される。 |

### JSON エクスポート・インポート

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-IE-JSON-001** | JSONエクスポート | 1. `test_world_sample.json` をインポートして開く<br>2. 左パネルから「プロジェクト(.json)」をエクスポート | 1. プロジェクト名（`テスト用：幻想王国アルテリア.json`）でファイルがダウンロードされる<br>2. ファイルの内容が、元のプロジェクトデータと一致する。 |
| **TC-IE-JSON-002** | JSONインポート (正常系) | 1. ローカルストレージをクリア<br>2. プロジェクト選択画面で「インポート」を押し、`test_world_sample.json` を選択 | 1. プロジェクトが正常に読み込まれ、執筆画面に遷移する<br>2. キャラクター、本文、設定などがすべて復元されている。 |
| **TC-IE-JSON-003** | JSONインポート (異常系 - 破損) | 1. JSONファイルの一部を意図的に削除・改変して保存<br>2. 破損したファイルをインポートしようとする | 「ファイルの読み込みに失敗しました」というアラートが表示され、アプリはクラッシュしない。 |
| **TC-IE-JSON-004** | JSONインポート (異常系 - 無関係) | 画像ファイルやテキストファイルなど、JSONではないファイルをインポートしようとする | ファイル選択ダイアログで選択できないか、選択してもエラーメッセージが表示され、アプリはクラッシュしない。 |
| **TC-IE-JSON-005** | 再インポート | 1. プロジェクトAをエクスポート<br>2. プロジェクトAが開かれている状態で、エクスポートしたファイルを再度インポート | プロジェクトAの内容がインポートしたファイルの内容で上書きされ、正常に表示される。 |

### TXT エクスポート

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-IE-TXT-001** | TXTエクスポート | 1. `test_world_sample.json` をインポートして開く<br>2. ヘッダーの「.txtで出力」ボタンを押す | 1. `テスト用：幻想王国アルテリア.txt` という名前のファイルがダウンロードされる<br>2. ファイルの内容が、プロジェクトの本文をプレーンテキストで連結したものになっている（章タイトル含む）。<br>3. ルビや太字などの書式は除去されている。 |

### HTML エクスポート

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-IE-HTML-001** | HTMLエクスポート (デフォルト) | 1. `test_world_sample.json` をインポートして開く<br>2. ヘッダーの「.htmlで出力」を押し、何も変更せずに「この設定で書き出す」を押す | 1. HTMLファイルがダウンロードされる<br>2. ブラウザで開くと、本文が表示され、目次や登場人物一覧も含まれている。 |
| **TC-IE-HTML-002** | オプション (表紙) | 1. HTML書き出しモーダルで「表紙」の著者名を入力し、画像をアップロード<br>2. 「画像付き」を選択して書き出す | 生成されたHTMLに、タイトル、著者名、画像を含む表紙ページが追加されている。 |
| **TC-IE-HTML-003** | オプション (スタイル) | 1. HTML書き出しモーダルで「現在の表示設定を使用する」のチェックを外す<br>2. テーマを「セピア」、フォントを「手書き風」に変更して書き出す | 生成されたHTMLの見た目が、指定したテーマとフォントになっている。 |
| **TC-IE-HTML-004** | オプション (コンテンツ) | 1. HTML書き出しモーダルで「目次を自動生成する」のチェックを外す<br>2. 「登場人物一覧」で特定のキャラクターのチェックを外して書き出す | 1. 生成されたHTMLに目次が含まれていない<br>2. チェックを外したキャラクターが登場人物一覧に含まれていない。 |
| **TC-IE-HTML-005** | 書き出し用説明文 | 1. HTML書き出しモーダルでキャラクターの「＋」ボタンを押し、書き出し用の説明文を編集して保存<br>2. 書き出す | 生成されたHTMLの登場人物紹介が、編集した説明文になっている。 |

---
