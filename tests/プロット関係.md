# プロット関連機能テスト設計書

## 概要
このドキュメントは、物語の構造を視覚的に管理するための3つの主要なツール（相関図、タイムライン、プロットボード）に関するテストケースを定義します。各ツールのCRUD（作成、読み取り、更新、削除）操作、インタラクティブな機能（ドラッグ＆ドロップなど）、そしてデータの保存と整合性を検証します。

## テスト目的
- 各プロットツールが、ユーザーの直感的な操作に対して正しく応答し、データを正確に管理できることを保証する。
- ツール間のデータ連携（例：タイムラインで世界観設定を参照）が正常に動作することを確認する。
- 複雑な操作を行っても、データの損失や破損が発生しないことを確認する。

## 前提条件
- `test_world_sample.json` のデータをインポートしたプロジェクトが開かれていること。

---

## テスト項目一覧

| 機能分類 | テスト項目 |
| :--- | :--- |
| **相関図** | ノード（キャラクター）の移動、関係性の追加・編集・削除 |
| **タイムライン** | レーンの追加・編集・削除、イベントの追加・編集・削除、イベントのD&D移動 |
| **プロットボード** | カードの追加・編集・削除、関係性の追加・編集・削除、カードのD&D移動 |

---

## 詳細テストケース

### 相関図 (Character Chart)

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-PLOT-CH-001** | モーダル表示 | 1. 左パネル「ツール」から「相関図を表示」を押す | 1. 相関図モーダルが表示される<br>2. 既存のキャラクター（リリア、カインなど）がノードとして表示されている。 |
| **TC-PLOT-CH-002** | ノードの移動 | ノード（キャラクターの円）の1つをドラッグ＆ドロップで別の場所に移動する | ノードがドラッグ先に移動する。リロードしても位置が保存されている。 |
| **TC-PLOT-CH-003** | 関係性の追加 | 1. 「関係を追加」モードにする<br>2. 「リリア」→「カイン」の順にクリック<br>3. 関係性編集フォームで「ラベル：ライバル」「色：赤」に設定し保存 | 1. 「リリア」から「カイン」への矢印が追加される<br>2. 矢印とラベルの色が赤になる。 |
| **TC-PLOT-CH-004** | 関係性の編集 | 既存の関係（矢印）をクリックする | 関係性編集フォームが表示され、ラベルや色を更新できる。 |
| **TC-PLOT-CH-005** | 関係性の削除 (線) | 1. 「関係を削除」モードにする<br>2. 既存の関係（矢印）をクリックする | クリックした関係性が削除される。 |
| **TC-PLOT-CH-006** | 関係性の削除 (ノード選択) | 1. 「関係を削除」モードにする<br>2. 関係を持つ2つのノードを順番にクリック<br>3. 確認ダイアログで「OK」を押す | 2つのノード間にある全ての関係性が削除される。 |

### タイムライン (Timeline)

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-PLOT-TL-001** | モーダル表示 | 1. 左パネル「ツール」から「タイムラインボードを開く」を押す | タイムラインモーダルが表示され、既存のレーンとイベントが表示される。 |
| **TC-PLOT-TL-002** | レーンの追加・編集 | 1. 「新しいレーンを追加」を押し、名前と色を設定して保存<br>2. 作成したレーンの編集アイコンから名前を変更 | 1. 新しいレーン（列）が追加される<br>2. レーン名が更新される |
| **TC-PLOT-TL-003** | イベントの追加 | 1. いずれかのレーンで「新規イベントを作成」を押す<br>2. タイトル、時期、詳細を入力して保存 | レーン内に新しいイベントカードが追加される。 |
| **TC-PLOT-TL-004** | イベントのD&D (同一レーン) | イベントカードを同じレーン内の別の位置にドラッグ＆ドロップする | イベントの順序が入れ替わる。 |
| **TC-PLOT-TL-005** | イベントのD&D (別レーン) | イベントカードを別のレーンにドラッグ＆ドロップする | イベントが別のレーンに移動する。 |
| **TC-PLOT-TL-006** | イベントの場所設定 | 1. イベント編集フォームを開く<br>2. 「発生場所」で既存の世界観設定（例：アルテリア王国）を選択<br>3. 保存する | イベントカードに場所のアイコンと名前が表示される。 |
| **TC-PLOT-TL-007** | 場所の新規追加連携 | 1. イベント編集フォームで「発生場所」を「その他」にし、自由入力欄に新しい地名を入力<br>2. 横の「＋」ボタンを押す | 新しい地名が世界観設定に自動で追加され、ドロップダウンで選択された状態になる。 |

### プロットボード (Plot Board)

| テストケースID | 対象機能 | 操作手順 | 期待結果 |
| :--- | :--- | :--- | :--- |
| **TC-PLOT-PB-001** | モーダル表示 | 1. 左パネル「プロットボード」から「すべて表示する」を押す | プロットボードモーダルが表示され、既存のカードが表示される。 |
| **TC-PLOT-PB-002** | カードの追加 | 1. 「新規カード作成」を押し、タイトル、種別、要約を入力して保存 | 新しいカードがボードに追加される。 |
| **TC-PLOT-PB-003** | カードのD&D | カードをドラッグ＆ドロップで別の場所に移動する | カードがドラッグ先に移動する。リロードしても位置が保存されている。 |
| **TC-PLOT-PB-004** | 関係性の追加 | 1. 「関係を追加」モードにする<br>2. カードA→カードBの順にクリック<br>3. 関係性編集フォームで設定し保存 | カードAからカードBへの矢印とラベルが表示される。 |
| **TC-PLOT-PB-005** | 関係性の編集・削除 | 1. 既存の関係（矢印）をクリックする<br>2. 「関係を削除」モードで矢印をクリックする | 1. 関係性編集フォームが表示され、更新できる<br>2. 関係性が削除される |
| **TC-PLOT-PB-006** | カード種別のカスタム作成 | 1. カード作成/編集時に、「種別」で「その他」を選択<br>2. 新しい種別名（例：伏線リスト）と色を設定して保存 | 1. 新しい種別でカードが作成される<br>2. カードの枠線が設定した色になる。 |

---
