# AIStudio 機能テストレポート

このドキュメントは、小説執筆支援アプリ「小説らいたー」の機能が、ユーザーの視点から見て正しく動作するかを確認するためのテスト仕様書です。

---

## 📝 アプリの概要

「小説らいたー」は、AIアシスタントと一緒に物語を作っていくための多機能な執筆ツールです。キャラクターや世界観などの細かい設定を管理しながら、AIに物語の続きを書いてもらったり、アイデアの相談をしたりすることができます。画面は主に、設定を管理する「左パネル」、物語の本文が表示される「中央パネル」、AIと会話する「右パネル」に分かれています。

---

## 機能別テストケース一覧

### 📂 個別機能：プロジェクト管理

| テストケースID | 機能名 | 前提条件 | 操作手順 | 期待される結果 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC001** | 新規プロジェクト作成 (標準モード) | プロジェクト選択画面が表示されている | 1. 「標準モード」を選択<br>2. タイトルを入力し「作成」を押す | 執筆画面（メイン画面）に遷移し、初回チュートリアルが開始される。 | |
| **TC002** | 新規プロジェクト作成 (シンプルモード) | プロジェクト選択画面が表示されている | 1. 「シンプルモード」を選択<br>2. タイトルを入力し「作成」を押す | 執筆画面に遷移する。<br>左パネルが簡易表示、右パネルが非表示になっている。 | |
| **TC003** | プロジェクトを開く | 既存のプロジェクトが1つ以上ある | 「既存の物語」リストからプロジェクトの「開く」ボタンを押す | 選択したプロジェクトの執筆画面に移動する。 | |
| **TC004** | プロジェクトの削除 | 既存のプロジェクトが1つ以上ある | 1. 削除したいプロジェクトの「ゴミ箱アイコン」を押す<br>2. 確認ダイアログで「OK」を押す | リストからプロジェクトが削除される。 | |
| **TC005** | プロジェクトのインポート | プロジェクト選択画面が表示されている | 1. 「プロジェクトをインポート」ボタンを押す<br>2. 有効な`.json`ファイルを選択する | 読み込んだプロジェクトの執筆画面に移動する。 | |
| **TC006** | プロジェクトのエクスポート | プロジェクトが開かれている | 左パネルの設定タブから「プロジェクト(.json)」をエクスポートする | プロジェクトデータを含む`.json`ファイルがダウンロードされる。 | |

### 🎨 個別機能：メイン画面UI・ナビゲーション

| テストケースID | 機能名 | 前提条件 | 操作手順 | 期待される結果 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC010** | 左サイドバー開閉 | プロジェクトが開かれている | 1. ヘッダーの左端にあるパネルアイコンを押す<br>2. 再度アイコンを押す | 1. 左サイドバーが閉じる<br>2. 左サイドバーが再度開く | ショートカットキー `Ctrl/⌘+[` でも同様の動作をすること。 |
| **TC011** | 右サイドバー開閉 | プロジェクトが開かれている | 1. ヘッダーの右端にあるパネルアイコンを押す<br>2. 再度アイコンを押す | 1. 右サイドバーが閉じる<br>2. 右サイドバーが再度開く | ショートカットキー `Ctrl/⌘+]` でも同様の動作をすること。 |
| **TC012** | サイドバーのリサイズ | 左右のサイドバーが表示されている | サイドバーと中央パネルの間にあるリサイズハンドルをドラッグする | ドラッグに応じてサイドバーの幅が変更される。 | |
| **TC013** | プロジェクトタイトルの編集 | プロジェクトが開かれている | 1. ヘッダーのプロジェクトタイトル部分をクリック<br>2. 新しいタイトルを入力し、Enterキーを押す | プロジェクト名が更新される。 | |
| **TC014** | モード切替 (シンプル/標準) | プロジェクトが開かれている | ヘッダーの「シンプルモードへ」または「標準モードへ」ボタンを押す | 画面レイアウトが選択したモードに切り替わる。 | |
| **TC015** | 左パネルタブ切替 | 標準モードでプロジェクトが開かれている | 左パネルのアイコン（キャラクター、世界観など）をクリックする | 対応する設定パネルに表示が切り替わる。 | |
| **TC016** | パネルのウィンドウ化 | 標準モードでプロジェクトが開かれている | 各パネルのヘッダーにある「ウィンドウ化」アイコンを押す | 対応するパネルが独立したフローティングウィンドウとして表示される。 | |

### 💬 個別機能：AIアシスタント

| テストケースID | 機能名 | 前提条件 | 操作手順 | 期待される結果 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC020** | AIモード切替 (相談) | プロジェクトが開かれている | 右パネルの「相談モード」ラジオボタンを選択する | AIへの指示を送信しても、中央パネルの本文は生成されない。 | |
| **TC021** | AIモード切替 (執筆) | プロジェクトが開かれている | 右パネルの「執筆モード」ラジオボタンを選択する | AIへの指示を送信すると、中央パネルに本文が生成される。 | |
| **TC022** | 指示の送信 (ボタン) | プロジェクトが開かれている | 1. 右パネルの入力欄に指示を入力<br>2. 「送信」ボタンを押す | AIが応答し、チャット履歴に追加される。 | |
| **TC023** | 指示の送信 (ショートカット) | プロジェクトが開かれている | 1. 右パネルの入力欄に指示を入力<br>2. `Ctrl/⌘+Enter` を押す | AIが応答し、チャット履歴に追加される。 | |
| **TC024** | 複数提案 (ON/OFF) | 執筆モードになっている | 「複数提案」のトグルスイッチをクリックする | トグルのON/OFFが切り替わる。 | 相談モードでは無効化されていること。 |
| **TC025** | 複数提案 (採用) | 複数提案がONの状態で本文を生成 | AIが提案した複数の展開の中から、1つの「この展開を採用」ボタンを押す | 選択した展開が本文に追加され、提案は消える。 | |
| **TC026** | 複数提案 (却下) | 複数提案がONの状態で本文を生成 | 提案の「却下」ボタンを押す | その提案がリストから消える。 | |
| **TC027** | 複数提案 (やり直し) | 全ての複数提案を却下した状態 | 「やり直す」ボタンを押す | AIが再度、同じ指示で複数の展開を生成する。 | |
| **TC028** | ナレッジ提案 (承認) | AIがナレッジを提案している状態 | 「承認」ボタンを押す | AIが提案した内容で、新しいナレッジ項目が自動で作成される。 | |
| **TC029** | ナレッジ提案 (却下) | AIがナレッジを提案している状態 | 「却下」ボタンを押す | 提案が消え、「提案履歴」モーダルに移動する。 | |
| **TC030** | プロット提案 (承認) | AIがプロットを提案している状態 | 「承認」ボタンを押す | AIが提案した内容で、新しいプロットカードが自動で作成される。 | |
| **TC031** | 提案履歴モーダル | | 右パネルの入力欄の下にある「提案履歴」リンクを押す | 却下した提案（ナレッジ/プロット）が一覧表示されるモーダルが開く。 | |
| **TC032** | 元に戻す (Undo) | 何らかの操作（本文生成など）を行った後 | 右パネルの「元に戻す」ボタンを押す | 直前の操作が取り消され、状態が1つ前に戻る。 | ショートカット `Ctrl/⌘+Z` でも同様。 |
| **TC033** | やり直す (Redo) | 「元に戻す」を実行した後 | 右パネルの「やり直す」ボタンを押す | 元に戻した操作が復元される。 | ショートカット `Ctrl/⌘+Y` でも同様。 |
| **TC034** | AI支援メニュー | | 右パネル入力欄の「＋」アイコンを押す | 「執筆補助」「アイデア出し」などのメニューが表示される。 | |
| **TC035** | 隠しコマンド (キャラ追加) | 相談モードで、本文中に存在する未登録キャラ名を使い「〇〇をキャラクターに追加して」と指示 | キャラクター設定モーダルが開き、本文から抽出された情報が自動入力されている。 | |

### ✍️ 個別機能：本文執筆・編集

| テストケースID | 機能名 | 前提条件 | 操作手順 | 期待される結果 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC040** | 段落の編集 (開始/保存) | 本文に段落が1つ以上ある | 1. 段落にマウスオーバーし「編集」アイコンを押す<br>2. テキストを修正し「保存」を押す | 1. 編集モードに切り替わる<br>2. 修正した内容が本文に反映される | ショートカット `Ctrl/⌘+Enter` でも保存できること。 |
| **TC041** | 段落のピン留め | 本文に段落が1つ以上ある | 段落にマウスオーバーし「ピン留め」アイコンを押す | 段落の背景色が変わり、ピン留めアイコンが表示される。<br>AIがより強く意識するようになる。 | |
| **TC042** | 編集ツールバー (太字) | 段落の編集モード中 | 1. テキストを選択<br>2. ツールバーの「太字」ボタンを押す | 選択したテキストが `**テキスト**` のように装飾される。 | |
| **TC043** | 編集ツールバー (ルビ) | 段落の編集モード中 | 1. テキストを選択<br>2. ツールバーの「ルビ」ボタンを押す | 選択したテキストが `{テキスト|}` のように変換され、ルビ入力位置にカーソルが移動する。 | |
| **TC044** | ナレッジリンクの作成・動作 | ナレッジに「太陽の剣」が登録済み | 1. 本文編集で `[[太陽の剣]]` と入力し保存<br>2. 保存後、本文中の「太陽の剣」リンクをクリック | 1. リンクとして表示される<br>2. 「太陽の剣」のナレッジ編集モーダルが開く | |
| **TC045** | テキスト選択ツールバー | | 本文のテキストを選択する | テキストの近くに小さなツールバー（校正して、など）が表示される。 | |
| **TC046** | 本文の直接入力 | | 中央パネル下部の「本文を直接入力」を開き、テキストを入力して「本文に追加」を押す | 入力した内容が新しい段落として本文の末尾に追加される。 | |

### ⚙️ 個別機能：設定管理

| テストケースID | 機能名 | 前提条件 | 操作手順 | 期待される結果 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC050** | キャラクター新規作成 (手動) | プロジェクトが開かれている | 左パネルのキャラクター「＋」ボタンを押し、情報を入力して保存 | 左パネルに新しいキャラクターカードが追加される。 | |
| **TC051** | キャラクターAIアシスタント (新規) | キャラクター新規作成モーダルを開く | 1. 「AIアシスタント」を起動<br>2. AIと会話し、「この内容を反映する」を押す | 会話内容がフォームに自動入力される。 | |
| **TC052** | キャラクターAIアシスタント (相談) | 既存キャラの編集モーダルを開き、AIアシスタントを起動 | 「相談する」ボタンでAIと会話する | プレビューのデータは変更されず、アイデア出しの会話ができる。 | |
| **TC053** | キャラクターAIアシスタント (設定反映) | 既存キャラの編集モーダルを開き、AIアシスタントを起動 | 「設定に反映」ボタンでAIに指示を出す | プレビューのデータがAIの指示内容で更新される。 | |
| **TC054** | AI立ち絵生成 | キャラクター編集モーダルで「AIで立ち絵を生成」を押す | 画像生成モーダルが開き、設定に基づいた画像を生成できる。 | |
| **TC055** | 相関図の編集 | | 「相関図を表示」ボタンでモーダルを開く | 関係の追加・編集・削除、ノードの移動が正常に動作し、保存できる。 | |
| **TC056** | タイムラインの編集 | | 「タイムラインボードを開く」ボタンでモーダルを開く | レーンとイベントの追加・編集・削除、イベントのドラッグ＆ドロップ移動が正常に動作し、保存できる。 | |
| **TC057** | プロットボードの編集 | | 「プロットボード」の「＋」または「すべて表示する」でモーダルを開く | カードと関係性の追加・編集・削除、カードの移動が正常に動作し、保存できる。 | |
| **TC058** | ナレッジベース一覧 | | 「ナレッジベース」の「すべて表示して検索」でモーダルを開く | ナレッジの一覧が表示され、検索やタグでの絞り込みができる。 | |
| **TC059** | アウトラインの並べ替え | | 左パネル「アウトライン」タブで、章をドラッグ＆ドロップする | 中央パネルの本文の章の順序が入れ替わる。 | |

### 🌐 個別機能：グローバル機能

| テストケースID | 機能名 | 前提条件 | 操作手順 | 期待される結果 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TC070** | 全体検索 | | ヘッダーの「検索」ボタンを押すか `Ctrl/⌘+F` | 1. 全体検索モーダルが開く<br>2. キーワードで検索すると、本文や設定から結果が表示される<br>3. 結果をクリックすると、該当箇所にジャンプする | |
| **TC071** | コマンドパレット | | `Ctrl/⌘+K` を押す | 1. コマンドパレットが開く<br>2. コマンドを検索し、Enterキーで実行できる | 例：「相関図」と入力して実行すると相関図モーダルが開く。 |
| **TC072** | スナップショット (バージョン管理) | 左パネル「バージョン管理」タブを開く | 1. 「スナップショットを保存」で現在の状態を保存できる<br>2. 「管理」から過去の状態に復元できる | | |
| **TC073** | チュートリアル | 新規ユーザーとして初めて標準モードのプロジェクトを開く | | アプリの基本的な使い方を案内するチュートリアルが自動で開始される。 | 2回目以降は表示されないこと。 |

---

## 操作フロー・シナリオテスト

### ✅ 代表シナリオ1：初回起動〜プロジェクト作成とチュートリアル体験

**シナリオ名**: 初めての物語を始める

**前提条件**: アプリのデータが何もない（初回起動時）

**手順**:
1. 🎨 アプリを起動する。
2. 🎨 プロジェクト選択画面で「**標準モード**」を選択する。
3. 🎨 「物語のタイトル」入力欄に「**星屑の冒険**」と入力する。
4. 🎨 「**作成**」ボタンを押す。
5. 🎨 画面に表示されるチュートリアルの指示に従い、「次へ」ボタンを最後までクリックし、「完了」を押す。

**期待結果**:
- ⚙️ 執筆画面（メイン画面）に遷移し、ヘッダーに「星屑の冒険」と表示される。
- 🎨 「小説らいたーへようこそ！」というチュートリアルが自動で開始される。
- 🎨 チュートリアルの各ステップで、対応するUI要素が正しくハイライトされる。
- ⚙️ チュートリアル完了後、UIが操作可能な状態になる。

### ✅ 代表シナリオ2：AIアシスタントによるキャラクターのゼロから作成

**シナリオ名**: 主人公をAIと一緒に作り上げる

**前提条件**: プロジェクトが開かれている状態。

**手順**:
1. 🎨 左パネル「キャラクター」の横にある「**＋**」ボタンを押す。
2. 🎨 表示されたキャラクター設定モーダルの右下にある「**AIアシスタント**」ボタンを押す。
3. 🎨 AIへの指示入力欄に「**元気で好奇心旺盛なトレジャーハンターの少年**」と入力し、「**送信**」ボタン（または `Ctrl+Enter`）を押す。
4. 💬 AIが「名前はどうしますか？」などと質問してくるので、「**名前は『レオ』で**」と返信する。
5. 🎨 会話を続けて設定がある程度固まったら、右下の「**この内容を反映する**」ボタンを押す。
6. 🎨 キャラクター設定モーダルのフォームに内容が自動入力されているのを確認し、「**保存**」ボタンを押す。

**期待結果**:
- 💬 AIとの会話内容に応じて、右側の「生成プレビュー」のデータ（名前、性格など）がリアルタイムで更新される。
- ⚙️ 「この内容を反映する」を押すと、元のフォームにプレビューの内容が正しくセットされる。
- ⚙️ 保存後、左パネルに「レオ」のキャラクターカードが追加される。

### ✅ 代表シナリオ3：相談モードでのアイデア出し

**シナリオ名**: AIに物語のアイデアを相談する

**前提条件**: プロジェクトが開かれている状態。

**手順**:
1. 🎨 右パネルのモード切替で「**相談モード**」を選択する。
2. 🎨 AIへの指示入力欄に「**レオが見つける伝説の宝物について、面白いアイデアを3つ提案して**」と入力する。
3. 🎨 「**送信**」ボタンを押す。

**期待結果**:
- 💬 ユーザーのチャット吹き出しが**ライムグリーン**で表示される。
- 💬 AIが宝物のアイデアを提案するチャットを返信する。
- ⚙️ **中央パネルの本文は一切生成されない。**

### ✅ 代表シナリオ4：執筆モードと複数提案機能の利用

**シナリオ名**: 物語の分岐をAIに提案させて執筆する

**前提条件**: プロジェクトが開かれている状態。

**手順**:
1. 🎨 右パネルのモード切替で「**執筆モード**」を選択する。
2. 🎨 「**複数提案**」のトグルスイッチをONにする。
3. 🎨 AIへの指示入力欄に「**レオが酒場で冒険の仲間を探すシーンを書いて**」と入力し、「**送信**」ボタンを押す。
4. 💬 AIが提案した複数の展開の中から、気に入ったものの「**この展開を採用**」ボタンを押す。

**期待結果**:
- 💬 AIが2〜3パターンの異なる展開案（タイトルと要約付き）を提示する。
- ⚙️ 採用した展開の本文が、中央パネルの末尾に正しく追加される。
- 🎨 他の提案は画面から消える。

### ✅ 代表シナリオ5：ナレッジの作成と本文へのリンク活用

**シナリオ名**: 作中用語をナレッジに登録し、本文から参照する

**前提条件**: プロジェクトが開かれている状態。

**手順**:
1. 🎨 左パネル「ナレッジベース」の横にある「**＋**」ボタンを押す。
2. ⚙️ 「名前：**賢者の羅針盤**」「内容：**古代遺跡の場所を示す魔法のアイテム**」と入力し、保存する。
3. 🎨 中央パネルの本文を編集モードにし、「レオは**[[賢者の羅針盤]]**を手に入れた。」と入力して保存する。
4. 🎨 本文に表示された青いリンク「**賢者の羅針盤**」をクリックする。

**期待結果**:
- ⚙️ ナレッジ項目が正しく保存される。
- 🎨 本文中の `[[賢者の羅針盤]]` がクリック可能なリンクとして表示される。
- 🎨 リンクをクリックすると、「賢者の羅針盤」のナレッジ編集モーダルが開く。

### ✅ 代表シナリオ6：AIからの提案の承認と履歴確認

**シナリオ名**: AIからの提案を一度断り、後から承認する

**前提条件**: AIとの会話中に「ナレッジ提案」が表示されている。

**手順**:
1. 💬 AIから提案されたナレッジ（例：「古代遺跡には守護者がいる」）の「**却下**」ボタンを押す。
2. 🎨 右パネルの入力欄の下にある「**提案履歴**」リンクを押す。
3. 🎨 表示された履歴モーダルで、先ほど却下した提案の「**この提案を承認**」ボタンを押す。

**期待結果**:
- 🎨 最初の提案がチャット欄から消える。
- 🎨 提案履歴モーダルが開き、却下した提案が表示されている。
- ⚙️ モーダルで承認すると、その内容で新しいナレッジ項目が自動で作成される。

### ✅ 代表シナリオ7：操作の取り消しとやり直し（Undo/Redo）

**シナリオ名**: 間違った操作を元に戻す

**前提条件**: 執筆モードで本文を1つ以上生成した後。

**手順**:
1. 🎨 右パネルの上部にある「**元に戻す**」（↩）ボタンを押す。
2. 🎨 少し待ってから、「**やり直す**」（↪）ボタンを押す。

**期待結果**:
- ⚙️ 「元に戻す」を押すと、直前に生成された本文と、それに対応するチャット履歴（ユーザーの指示とAIの応答）が消える。
- ⚙️ 「やり直す」を押すと、消えた本文とチャット履歴が元通りに復元される。

### ✅ 代表シナリオ8：隠しコマンドによるキャラクターの自動追加

**シナリオ名**: 本文からキャラクター情報を自動で抽出する

**前提条件**: 本文に「**謎の少女『セナ』がレオの前に現れた。彼女は銀色の髪をしていた。**」のように、まだキャラクターとして登録していない人物の描写がある。

**手順**:
1. 🎨 右パネルを「**相談モード**」にする。
2. 💬 AIへの指示入力欄に「**セナをキャラクターに追加して**」と入力し、送信する。

**期待結果**:
- 🎨 キャラクター設定モーダルが自動で開く。
- ⚙️ 「名前」欄に「セナ」が入力されている。
- ⚙️ 「容姿特徴リスト」などに「髪の色：銀色」のように、本文から抽出された情報が自動で入力されている。

### ✅ 代表シナリオ9：隠しコマンドによるプロットの自動生成

**シナリオ名**: AIにここまでの話をまとめてもらう

**前提条件**: 本文が数ブロック程度進んでいる。

**手順**:
1. 🎨 右パネルを「**相談モード**」にする。
2. 💬 AIへの指示入力欄に「**ここまでの物語のあらすじをまとめて**」と入力し、送信する。

**期待結果**:
- 💬 AIが本文の要約をチャットで返信する。
- 🎨 同時に「**プロット提案**」が表示される。
- ⚙️ 「承認」すると、要約が「章のまとめ」としてプロットボードに自動で追加される。

### ✅ 代表シナリオ10：全体検索と本文へのジャンプ

**シナリオ名**: 物語が長くなってきたので、特定のシーンを探す

**前提条件**: プロジェクトに複数の設定と本文がある。

**手順**:
1. 🎨 ヘッダーの「**検索**」ボタン（または `Ctrl+F`）を押す。
2. 🎨 検索モーダルで、本文中に登場するキーワード（例：「酒場」）を入力する。
3. 🎨 結果一覧に表示された「小説本文」の項目をクリックする。

**期待結果**:
- 🎨 検索モーダルが開く。
- 🎨 入力したキーワードを含むキャラクター、ナレッジ、本文などが一覧で表示される。
- 🎨 結果をクリックすると、モーダルが閉じて中央パネルの該当箇所まで自動でスクロールする。

---

## 🧩 テスト完了チェックリスト

- [ ] 全機能を網羅
- [ ] エラー・例外動作確認済み
- [ ] UI崩れなし
- [ ] シナリオ動作確認済み
- [ ] AI応答・提案内容確認済み
